\section{Cholesky}

Assuming we already have the cholesky decomposition \(L_n\) of \(\Sigma_n\),
can we find the cholesky decomposition \(L_{n+1}\) of the extended covariance
matrix \(\Sigma_{n+1}\) faster? It turns out yes, as
\[
	\begin{aligned}
	L_{n+1}L_{n+1}^T
	&=\begin{pmatrix}
		L & \\
		l^T &\lambda
	\end{pmatrix}
	\begin{pmatrix}
		L^T &  l\\
		&\lambda^T
	\end{pmatrix}
	= \begin{pmatrix}
		L L^T & L l\\
		l^T L^T & l^T l + \lambda\lambda^T
	\end{pmatrix}\\
	\overset!&= \begin{pmatrix}
		\Sigma_n & c_n \\
		c_n & \sigma_n^2
	\end{pmatrix} = \Sigma_{n+1}
	\end{aligned}
\]
implies \(L = L_n\) and
\[
	l_n := l = L^{-1}c_n.
\]
And finally
\[
	\lambda_n := \lambda = \text{chol}(\sigma^2 - l^T l),
\]
where \(\text{chol}(\Sigma)\) is the cholesky decomposition of \(\Sigma\). In
one dimension this coincides with the square root.


\[
	\begin{pmatrix}
		L & \\
		l & \lambda
	\end{pmatrix}
	\begin{pmatrix}
		Y_1\\
		\vdots\\
		Y_{n+1}
	\end{pmatrix}
	= \begin{pmatrix}
		L Y_{:n} \\
	 	l Y_{:n} + \lambda Y_{n+1}
	\end{pmatrix}
\]